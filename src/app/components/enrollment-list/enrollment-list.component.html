<!-- src/app/components/enrollment-list/enrollment-list.component.html -->
<div class="container mt-4">
  <!-- Header with Add Button -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Enrollments</h2>
    <button class="btn btn-primary" routerLink="/enrollments/new">
      <i class="bi bi-plus-circle me-1"></i> Add New Enrollment
    </button>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="loading" class="text-center">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <!-- Enrollment Table -->
  <div *ngIf="!loading && !error">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Student</th>
          <th>Course</th>
          <th>Enrollment Date</th>
          <th>Grade</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let enrollment of enrollments">
          <td>{{ enrollment.id }}</td>

          <!-- Student Name Column -->
          <td>
            <div *ngIf="enrollment.student; else studentId">
              <strong>{{ enrollment.student.name }}</strong>
              <div class="text-muted small">
                {{ enrollment.student.email }}
                <br>
                <small>ID: {{ enrollment.student.id }}</small>
              </div>
            </div>
            <ng-template #studentId>
              <span class="text-muted">Student ID: {{ enrollment.studentId || 'N/A' }}</span>
            </ng-template>
          </td>

          <!-- Course Name Column -->
          <td>
            <div *ngIf="enrollment.course; else courseId">
              <strong>{{ enrollment.course.name }}</strong>
              <div class="text-muted small">
                {{ enrollment.course.department || 'No Department' }}
                <br>
                <small>ID: {{ enrollment.course.id }}</small>
              </div>
            </div>
            <ng-template #courseId>
              <span class="text-muted">Course ID: {{ enrollment.courseId || 'N/A' }}</span>
            </ng-template>
          </td>

          <!-- Enrollment Date with built-in pipe -->
          <td>{{ enrollment.enrollmentDate | date:'mediumDate' }}</td>

          <!-- Grade with Color Coding -->
          <td>
            <span [ngClass]="{
              'badge bg-success': enrollment.grade === 'A' || enrollment.grade === 'A+',
              'badge bg-warning': enrollment.grade === 'B' || enrollment.grade === 'C',
              'badge bg-danger': enrollment.grade === 'D' || enrollment.grade === 'F' || enrollment.grade === 'W',
              'badge bg-secondary': !enrollment.grade}">
              {{ enrollment.grade || 'No Grade' }}
            </span>
          </td>

          <!-- Status with CUSTOM PIPE - FIXED LINE -->
          <td>
            <span [ngClass]="enrollment.status | statusColor">
              {{ enrollment.status }}
            </span>
          </td>

          <!-- Actions -->
          <td>
            <div class="btn-group" role="group">
              <button
                class="btn btn-sm btn-outline-primary"
                [routerLink]="['/enrollments/edit', enrollment.id]">
                <i class="bi bi-pencil"></i> Edit
              </button>
              <button
                class="btn btn-sm btn-outline-danger"
                (click)="deleteEnrollment(enrollment.id!)">
                <i class="bi bi-trash"></i> Delete
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Empty State -->
    <div *ngIf="enrollments.length === 0" class="text-center py-5">
      <i class="bi bi-calendar-x" style="font-size: 3rem; color: #6c757d;"></i>
      <h4 class="mt-3">No Enrollments Found</h4>
      <p class="text-muted">Click "Add New Enrollment" to create your first enrollment.</p>
    </div>
  </div>
</div>
